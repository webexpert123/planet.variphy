/*! 
 * BuddyBoss Theme JavaScript Library 
 * @package BuddyBoss Theme 
 */
jQuery(function(j){function x(e,o,i){if(e.find(".bbp-reply-form form").find("#bbp-template-notices").html(""),"undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media){e.find(".gif-media-search-dropdown").removeClass("open"),e.find("#whats-new-toolbar .toolbar-button").removeClass("active disable");var t=e.find("#whats-new-attachments .forums-attached-gif-container");t.length&&(t.addClass("closed"),t.find(".gif-image-container img").attr("src",""),t[0].style=""),e.find("#bbp_media_gif").length&&e.find("#bbp_media_gif").val(""),void 0!==o&&i&&(void 0!==bp.Nouveau.Media.dropzone_obj[o]&&(bp.Nouveau.Media.dropzone_obj[o].destroy(),bp.Nouveau.Media.dropzone_obj.splice(o,1),bp.Nouveau.Media.dropzone_media.splice(o,1)),e.find('div#forums-post-media-uploader[data-key="'+o+'"]').html(""),e.find('div#forums-post-media-uploader[data-key="'+o+'"]').addClass("closed").removeClass("open"),e.find('div#forums-post-document-uploader[data-key="'+o+'"]').html(""),e.find('div#forums-post-document-uploader[data-key="'+o+'"]').addClass("closed").removeClass("open"),e.find('div#forums-post-video-uploader[data-key="'+o+'"]').html(""),e.find('div#forums-post-video-uploader[data-key="'+o+'"]').addClass("closed").removeClass("open"))}}j("body").hasClass("reply-edit")||j(document).on("submit",".bbp-reply-form form",function(e){if(e.preventDefault(),j(this).hasClass("submitting"))return!1;j(this).addClass("submitting");var o=!0,i=!0,t=j(e.target).find(".bbp-the-content").data("key"),d=!1;void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[t]&&(d=window.forums_medium_reply_editor[t]),(0<j(this).find("#bbp_media").length&&0<j(this).find("#bbp_document").length&&0<j(this).find("#bbp_video").length&&0<j(this).find("#bbp_media_gif").length&&""==j(this).find("#bbp_media").val()&&""==j(this).find("#bbp_document").val()&&""==j(this).find("#bbp_video").val()&&""==j(this).find("#bbp_media_gif").val()||0<j(this).find("#bbp_media").length&&0<j(this).find("#bbp_document").length&&0<j(this).find("#bbp_video").length&&j(this).find("#bbp_media_gif").length<=0&&""==j(this).find("#bbp_media").val()&&""==j(this).find("#bbp_video").val()&&""==j(this).find("#bbp_document").val()||0<j(this).find("#bbp_media_gif").length&&j(this).find("#bbp_media").length<=0&&j(this).find("#bbp_document").length<=0&&j(this).find("#bbp_video").length<=0&&""==j(this).find("#bbp_media_gif").val())&&(i=!1),d&&""===j(j.parseHTML(j(this).find("#bbp_reply_content").val())).text().trim()&&0==i?(j(this).find(".bbp-the-content").addClass("error"),o=!1):d||""!==j.trim(j(this).find("#bbp_reply_content").val())||0!=i?(d&&j(this).find(".bbp-the-content").removeClass("error"),j(this).find("#bbp_reply_content").removeClass("error")):(j(this).find("#bbp_reply_content").addClass("error"),o=!1),o?function(e,o,i,t){var g={action:e,nonce:o};j.each(i,function(e,o){"action"===o.name?g.bbp_reply_form_action=o.value:g[o.name]=o.value});var C=t.closest("#bbpress-forums");j.post(window.bbpReplyAjaxJS.bbp_ajaxurl,g,function(e){if(e.success){C.find(".bbp-reply-form form").removeClass("submitting");var o="",i=j(".bb-quick-reply-form-wrap");if("edit"===e.reply_type)o='<li class="highlight">'+e.content+"</li>",j("#post-"+e.reply_id).parent("li").replaceWith(o);else{if(window.bbpReplyAjaxJS.threaded_reply&&e.reply_parent&&e.reply_parent!==e.reply_id){var t=null,d="1";if(j("#post-"+e.reply_parent).parent("li").data("depth")==window.bbpReplyAjaxJS.threaded_reply_depth){var r=parseInt(window.bbpReplyAjaxJS.threaded_reply_depth)-1;t=j("#post-"+e.reply_parent).closest("li.depth-"+r),d=window.bbpReplyAjaxJS.threaded_reply_depth}else t=j("#post-"+e.reply_parent).parent("li"),d=parseInt(t.data("depth"))+1;var a="ul";C.find(".bb-single-reply-list").is("ol")&&(a="ol"),t.find(">"+a+".bbp-threaded-replies").length||t.append("<"+a+' class="bbp-threaded-replies"></'+a+">"),o='<li class="highlight depth-'+d+'" data-depth="'+d+'">'+e.content+"</li>",t.find(">"+a+".bbp-threaded-replies").append(o)}else if(e.current_page==e.total_pages)o='<li class="highlight depth-1" data-depth="1">'+e.content+"</li>",C.find(".bb-single-reply-list").append(o);else{var n=e.redirect_url,p=n.substring(0,n.indexOf("#"));i.length||i.is(":visible")||(window.location.href=p)}jQuery(window).scroll()}if(""!==e.tags){var l=j("body .item-tags"),s=j("body .item-tags ul");"none"===l.css("display")?(l.append(e.tags),l.show()):(s.remove(),l.append(e.tags))}""!=o&&(j("body").animate({scrollTop:j(o).offset().top},500),setTimeout(function(){j(o).removeClass("highlight")},2e3));var b=C.find(".bbp-reply-form form").find("#forums-post-media-uploader").data("key"),m=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[b]&&bp.Nouveau.Media.dropzone_media[b].length){m=!0;for(var u=0;u<bp.Nouveau.Media.dropzone_media[b].length;u++)bp.Nouveau.Media.dropzone_media[b][u].saved=!0}var f=C.find(".bbp-reply-form form").find("#forums-post-document-uploader").data("key"),c=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[f]&&bp.Nouveau.Media.dropzone_media[f].length){c=!0;for(u=0;u<bp.Nouveau.Media.dropzone_media[f].length;u++)bp.Nouveau.Media.dropzone_media[f][u].saved=!0}var _=C.find(".bbp-reply-form form").find("#forums-post-video-uploader").data("key"),v=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[_]&&bp.Nouveau.Media.dropzone_media[_].length){v=!0;for(u=0;u<bp.Nouveau.Media.dropzone_media[_].length;u++)bp.Nouveau.Media.dropzone_media[_][u].saved=!0}var h=C.find(".bbp-reply-form form").find(".bbp-the-content").data("key");void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[h]&&(window.forums_medium_reply_editor[h].execAction("selectAll"),window.forums_medium_reply_editor[h].execAction("removeFormate"),window.forums_medium_reply_editor[h].resetContent()),C.find(".bbp-reply-form form").find(".bbp-the-content").removeClass("error"),i.length&&i.is(":visible")?C.find(".bbp-reply-form").hide():C.find("#bbp-close-btn").trigger("click"),C.find("#bbp_reply_content").val(""),x(C,b,m),x(C,f,c),x(C,_,v);var y=C.find(".scrubberpost");if(y.length)for(var w in y)if(j(y[w]).hasClass("post-"+e.reply_id)){window.BuddyBossThemeBbpScrubber.goToPost(parseInt(w,10)+1,"");break}}else void 0!==e.content&&C.find(".bbp-reply-form form").find("#bbp-template-notices").html(e.content);C.find(".bbp-reply-form form").removeClass("submitting"),j(".bbp-reply-form").trigger("bbp_after_submit_reply_form",{response:e,topic_id:g.bbp_topic_id})})}("reply",window.bbpReplyAjaxJS.reply_nonce,j(this).serializeArray(),j(this)):j(this).removeClass("submitting")});var s={init:function(){this.ajax_call()},ajax_call:function(){j(document).on("click",'a[data-btn-id="bbp-reply-form"]',function(e){e.preventDefault();var o=j(this),i=o.closest("li"),r=o.data("topic-id"),a=i.find(".activity-discussion-title-wrap a").text(),t=i.data("bp-activity"),d=t.group_id?t.group_id:0;j(".bb-quick-reply-form-wrap").length&&j(".bb-quick-reply-form-wrap").remove(),j("body").append('<div class="bb-modal-overlay js-modal-close"></div>'),j(".bb-modal-overlay").fadeTo(500,.7);var n=o.closest(".bb-grid .content-area"),p='<div id="bbpress-forums" class="bbpress-forums-activity bb-quick-reply-form-wrap"><div class="bbp-reply-form bb-modal bb-modal-box"><form id="new-post" name="new-post" method="post" action=""><fieldset class="bbp-form"><legend>'+window.bbpReplyAjaxJS.reply_to_text+' <span id="bbp-reply-exerpt"> '+a+'...</span><a href="#" id="bbp-close-btn" class="js-modal-close"><i class="bb-icon-close"></i></a></legend><div><div class="bbp-the-content-wrapper"><div class="bbp-the-content bbp_editor_reply_content medium-editor-element" contenteditable="true" data-placeholder="'+window.bbpReplyAjaxJS.type_reply_here_text+'"></div></div></fieldset></form></div></div>';n.append(p),n.find(".bb-quick-reply-form-wrap").show().find(".bbp-reply-form").addClass("bb-modal bb-modal-box").show(),n.find(".bb-quick-reply-form-wrap .bbp-the-content-wrapper").addClass("loading").show();var l={action:"quick_reply_ajax",topic_id:r,group_id:d,"bbp-ajax":1};j.post(ajaxurl,l,function(e){if(n.append(e),n.find("div.bb-quick-reply-form-wrap").length){var o=n.find("div.bb-quick-reply-form-wrap");if(o.show(),o.find(".bbp-reply-form").length&&(o.find(".bbp-reply-form").addClass("bb-modal bb-modal-box"),o.find(".bbp-reply-form").show(),o.find(".bbp-reply-form").find("#bbp-reply-exerpt").text(a+"..."),o.find(".bbp-reply-form").find("#bbp_topic_id").val(r),s.addSelect2(o),s.addEditor(o),"undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media)){if(void 0!==bp.Nouveau.Media.options){var i=o.find(".bbp-reply-form").find(".forum-post-media-template").length?o.find(".bbp-reply-form").find(".forum-post-media-template")[0].innerHTML:"";bp.Nouveau.Media.options.previewTemplate=i}if(void 0!==bp.Nouveau.Media.documentOptions){var t=o.find(".bbp-reply-form").find(".forum-post-document-template").length?o.find(".bbp-reply-form").find(".forum-post-document-template")[0].innerHTML:"";bp.Nouveau.Media.documentOptions.previewTemplate=t}if(void 0!==bp.Nouveau.Media.videoOptions){var d=o.find(".bbp-reply-form").find(".forum-post-video-template").length?o.find(".bbp-reply-form").find(".forum-post-video-template")[0].innerHTML:"";bp.Nouveau.Media.videoOptions.previewTemplate=d}}o.find(".bbp-no-reply").length&&(o.find(".bbp-no-reply").addClass("bb-modal bb-modal-box"),o.find(".bbp-no-reply").show())}})})},addSelect2:function(e){var o=e.find(".bbp_topic_tags_dropdown"),d=[];o.length&&(o.select2({placeholder:o.attr("placeholder"),minimumInputLength:1,closeOnSelect:!0,tags:!0,language:"undefined"!=typeof bp_select2&&void 0!==bp_select2.lang?bp_select2.lang:"en",dropdownCssClass:"bb-select-dropdown",containerCssClass:"bb-select-container",tokenSeparators:[","," "],ajax:{url:bbpCommonJsData.ajax_url,dataType:"json",delay:1e3,data:function(e){return j.extend({},e,{_wpnonce:bbpCommonJsData.nonce,action:"search_tags"})},cache:!0,processResults:function(t){return!1===j.isEmptyObject(d)&&j.each(d,function(e,o){for(var i=0;i<t.data.results.length;i++)t.data.results[i].id===o&&t.data.results.splice(i,1)}),{results:t&&t.success?t.data.results:[]}}}}),o.on("select2:select",function(e){var o=e.params.data;d.push(o.id);var i=d.join(",");j("body #bbp_topic_tags").val(i),j("body .select2-search__field").trigger("click"),j("body .select2-search__field").trigger("click")}),o.on("select2:unselect",function(e){var o=e.params.data,i=(d=j.grep(d,function(e){return e!==o.id})).join(",");j("body #bbp_topic_tags").val(i),0===i.length&&j(window).scrollTop(j(window).scrollTop()+1)}))},addEditor:function(o){if(void 0!==window.MediumEditor){var i={buttons:["bold","italic","unorderedlist","orderedlist","quote","anchor","pre"],relativeContainer:document.getElementById("whats-new-toolbar"),static:!0,updateOnEmptySelection:!0};o.find(".bbp_editor_reply_content").length&&(window.forums_medium_reply_editor=[],o.find(".bbp_editor_reply_content").each(function(e,t){var d=j(t).data("key");window.forums_medium_reply_editor[d]=new window.MediumEditor(t,{placeholder:{text:window.bbpEditorJsStrs.type_reply,hideOnClick:!0},toolbar:i,paste:{forcePlainText:!1,cleanPastedHTML:!0,cleanReplacements:[[new RegExp(/<div/gi),"<p"],[new RegExp(/<\/div/gi),"</p"],[new RegExp(/<h[1-6]/gi),"<b"],[new RegExp(/<\/h[1-6]/gi),"</b"]],cleanAttrs:["class","style","dir","id"],cleanTags:["meta","div","main","section","article","aside","button","svg","canvas","figure","input","textarea","select","label","form","table","thead","tfooter","colgroup","col","tr","td","th","dl","dd","center","caption","nav"],unwrapTags:["ul","ol","li"]},imageDragging:!1}),window.forums_medium_reply_editor[d].subscribe("editableInput",function(){var e=j(t).closest("form").find("#bbp_reply_content"),o=window.forums_medium_reply_editor[d].getContent(),i=document.createElement("div");i.innerHTML=o,j(i).find("span.atwho-query").replaceWith(function(){return this.innerText}),j(i).find("img.emoji").each(function(e,o){j(o).addClass("emojioneemoji");var i=j(o).attr("alt");j(o).attr("data-emoji-char",i),j(o).removeClass("emoji")}),j(i).find("img.emojioneemoji").replaceWith(function(){return this.dataset.emojiChar}),e.val(j(i).html())}),o.on("click","#whats-new-toolbar .show-toolbar",function(e){e.preventDefault();var o=j(e.currentTarget).closest(".bbp-reply-form").find(".bbp_editor_reply_content").data("key"),i=j(e.currentTarget).closest(".bbp-form").find(".medium-editor-toolbar");j(e.currentTarget).find(".toolbar-button").toggleClass("active"),j(e.currentTarget).find(".toolbar-button").hasClass("active")?(j(e.currentTarget).attr("data-bp-tooltip",j(e.currentTarget).attr("data-bp-tooltip-hide")),null!==window.forums_medium_reply_editor[o].exportSelection()&&i.addClass("medium-editor-toolbar-active")):(j(e.currentTarget).attr("data-bp-tooltip",j(e.currentTarget).attr("data-bp-tooltip-show")),null===window.forums_medium_reply_editor[o].exportSelection()&&i.removeClass("medium-editor-toolbar-active")),j(window.forums_medium_reply_editor[o].elements[0]).focus(),i.toggleClass("active")})})),"undefined"!=typeof BP_Nouveau&&void 0!==BP_Nouveau.media&&void 0!==BP_Nouveau.media.emoji&&o.find(".bbp_editor_reply_content").length&&void 0!==j.prototype.emojioneArea&&o.find(".bbp_editor_reply_content").each(function(e,o){var i=j(o).attr("id"),t=j(o).data("key");j("#"+i).emojioneArea({standalone:!0,hideSource:!1,container:j("#"+i).closest("form").find("#whats-new-toolbar > .post-emoji"),autocomplete:!1,pickerPosition:"bottom",hidePickerOnBlur:!0,useInternalCDN:!1,events:{ready:function(){void 0!==window.forums_medium_topic_editor&&void 0!==window.forums_medium_topic_editor[t]&&window.forums_medium_topic_editor[t].resetContent(),void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[t]&&window.forums_medium_reply_editor[t].resetContent(),void 0!==window.forums_medium_forum_editor&&void 0!==window.forums_medium_forum_editor[t]&&window.forums_medium_forum_editor[t].resetContent()},emojibtn_click:function(){void 0!==window.forums_medium_topic_editor&&void 0!==window.forums_medium_topic_editor[t]&&window.forums_medium_topic_editor[t].checkContentChanged(),void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[t]&&window.forums_medium_reply_editor[t].checkContentChanged(),void 0!==window.forums_medium_forum_editor&&void 0!==window.forums_medium_forum_editor[t]&&window.forums_medium_forum_editor[t].checkContentChanged(),j("#"+i)[0].emojioneArea.hidePicker()}}})})}}};s.init()});