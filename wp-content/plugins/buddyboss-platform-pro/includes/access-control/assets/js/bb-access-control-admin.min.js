window.bp=window.bp||{},function(n){bp.Access_Control_Admin={start:function(){this.setupGlobals(),this.addListeners()},setupGlobals:function(){},addListeners:function(){n(document).on("change",".access-control-select-box",this.showAccessControlSelect.bind(this)),n(document).on("change",".access-control-plugin-select-box",this.showPluginAccessControlSelect.bind(this)),n(document).on("change",".access-control-gamipress-select-box",this.showGamiPressAccessControlSelect.bind(this)),n(document).on("change",'.access-control-checkbox-list .parent input[type="checkbox"]',this.enableDisableOptions.bind(this)),n(document).on("change",".chb",this.enableDisableOptionsAllOrSpecific.bind(this)),n(document).on("change",".access-control-threaded-input",this.showHideChildDiv.bind(this)),n(window).on("load",this.changeNotices.bind(this)),n(document).on("change","input#bp_restrict_group_creation",this.group_creation_restrict.bind(this)),n(document).on("change","input#bp_media_profile_media_support, input#bp_media_messages_media_support, input#bp_media_forums_media_support",this.upload_photo_restrict.bind(this)),n(document).on("change","input#bp_video_profile_video_support, input#bp_video_messages_video_support, input#bp_video_forums_video_support",this.upload_video_restrict.bind(this)),n(document).on("change","input#bp_media_profile_document_support, input#bp_media_messages_document_support, input#bp_media_forums_document_support",this.upload_document_restrict.bind(this))},showHideChildDiv:function(e){var s=e.currentTarget,c=n(s).data("id"),t=n(s).closest(".parent."+c).next(".access-control-checkbox-list.child-"+c).find(".multiple_options"),o=n(s).closest(".parent."+c).next(".access-control-checkbox-list").find('input[type="checkbox"]'),i=n(s).closest(".parent."+c).next(".access-control-checkbox-list.child-"+c),l=n(s).closest(".parent."+c).next(".access-control-checkbox-list.child-"+c).find(".sub-child-"+c);n(s).prop("checked")?(t.children('input[data-value="all"]').trigger("click"),o.removeProp("disabled"),i.removeClass("access-control-hide-div"),i.children('input[data-value="all"]').trigger("click")):(t.children('input[data-value="all"]').trigger("click"),o.prop("disabled","disabled"),o.removeProp("checked"),l.addClass("access-control-hide-div"),i.addClass("access-control-hide-div")),bp.Access_Control_Admin.changeNotices()},enableDisableOptionsAllOrSpecific:function(e){var s=e.currentTarget,c=n(s).data("value"),t=n(s).data("id"),o=n(s).closest(".access-control-checkbox-list.child-"+t).find(".sub-child-"+t),i=n(s).closest(".access-control-checkbox-list.child-"+t).find(".sub-child-"+t+' input[type="checkbox"]');"specific"===c?o.length&&(i.attr("disabled",!1),o.parent().removeClass("access-control-hide-div"),o.removeClass("access-control-hide-div")):(i.prop("checked",!1),o.length&&(o.parent().addClass("access-control-hide-div"),o.addClass("access-control-hide-div"))),n(s).siblings(".chb").prop("checked",!1),n(s).prop("checked",!0)},showPluginAccessControlSelect:function(e){var s=e.currentTarget,c=n(s).val(),t=n(s).data("id"),o=n(s).hasClass("display-threaded"),i=n(s).data("label"),l=n(s).data("sub-label"),a=n(s).data("component-settings");if(""===c)n(s).siblings(".access-control-checkbox-list").html("");else{if(n(s).hasClass("loading"))return;n(s).addClass("loading"),n('<div class="loader-repair-tools" style="vertical-align: middle"></div>').insertAfter(s),n.ajax({type:"POST",url:bbAccessControlAdminVars.ajax_url,data:{action:"plugin_get_access_control_level_options",value:c,key:t,threaded:o,label:i,sub_label:l,component_settings:a},success:function(e){n(s).siblings(".loader-repair-tools").remove(),n(s).removeClass("loading"),void 0!==e.data&&e.data.message?(n(s).siblings(".access-control-checkbox-list").html(""),n(s).siblings(".access-control-checkbox-list").html(e.data.message),n(s).siblings(".access-control-checkbox-list").find('.access-control-checkbox-list input[type="checkbox"]').prop("disabled","disabled"),bp.Access_Control_Admin.changeNotices()):n(s).siblings(".access-control-checkbox-list").html("")},error:function(){n(s).removeClass("loading"),n(s).siblings(".loader-repair-tools").remove()}})}},showGamiPressAccessControlSelect:function(e){var s=e.currentTarget,c=n(s).val(),t=n(s).data("id"),o=n(s).hasClass("display-threaded"),i=n(s).data("label"),l=n(s).data("sub-label"),a=n(s).data("component-settings");if(""===c)n(s).siblings(".access-control-checkbox-list").html("");else{if(n(s).hasClass("loading"))return;n(s).addClass("loading"),n('<div class="loader-repair-tools" style="vertical-align: middle"></div>').insertAfter(s),n.ajax({type:"POST",url:bbAccessControlAdminVars.ajax_url,data:{action:"gamipress_get_access_control_level_options",value:c,key:t,threaded:o,label:i,sub_label:l,component_settings:a},success:function(e){n(s).siblings(".loader-repair-tools").remove(),n(s).removeClass("loading"),void 0!==e.data&&e.data.message?(n(s).siblings(".access-control-checkbox-list").html(""),n(s).siblings(".access-control-checkbox-list").html(e.data.message),n(s).siblings(".access-control-checkbox-list").find('.access-control-checkbox-list input[type="checkbox"]').prop("disabled","disabled"),bp.Access_Control_Admin.changeNotices()):n(s).siblings(".access-control-checkbox-list").html("")},error:function(){n(s).removeClass("loading"),n(s).siblings(".loader-repair-tools").remove()}})}},showAccessControlSelect:function(e){var s=e.currentTarget,c=n(s).val(),t=n(s).hasClass("display-threaded"),o=n(s).data("label"),i=n(s).data("sub-label"),l=n(s).data("component-settings");if(""===c)n(s).siblings(".access-control-plugin-select-box").addClass("hidden"),n(s).siblings(".access-control-gamipress-select-box").addClass("hidden"),n(s).siblings(".access-control-checkbox-list").html("");else{if(n(s).hasClass("loading"))return;n(s).addClass("loading"),n(s).siblings(".access-control-gamipress-select-box").prop("selectedIndex",0),n(s).siblings(".access-control-plugin-select-box").prop("selectedIndex",0);var a=n(s).attr("id");"membership"===c?(n(s).siblings(".access-control-gamipress-select-box").addClass("hidden"),n(s).removeClass("loading").siblings(".access-control-plugin-select-box").removeClass("hidden"),n(s).siblings(".select-before-label").removeClass("hidden"),n(s).siblings(".select-after-label").removeClass("hidden"),n(s).siblings(".access-control-checkbox-list").html("")):"gamipress"===c?(n(s).siblings(".access-control-plugin-select-box").addClass("hidden"),n(s).siblings(".select-before-label").addClass("hidden"),n(s).siblings(".select-after-label").addClass("hidden"),n(s).removeClass("loading").siblings(".access-control-gamipress-select-box").removeClass("hidden"),n(s).siblings(".access-control-checkbox-list").html("")):(n(s).siblings(".access-control-plugin-select-box").addClass("hidden"),n(s).siblings(".select-before-label").addClass("hidden"),n(s).siblings(".select-after-label").addClass("hidden"),n(s).siblings(".access-control-gamipress-select-box").addClass("hidden"),n('<div class="loader-repair-tools" style="vertical-align: middle"></div>').insertAfter(s),n.ajax({type:"POST",url:bbAccessControlAdminVars.ajax_url,data:{action:"get_access_control_level_options",value:c,key:a,threaded:t,label:o,sub_label:i,component_settings:l},success:function(e){n(s).siblings(".loader-repair-tools").remove(),void 0!==e.data&&e.data.message?(n(s).siblings(".access-control-checkbox-list").html(""),n(s).siblings(".access-control-checkbox-list").html(e.data.message),n(s).siblings(".access-control-checkbox-list").find('.access-control-checkbox-list input[type="checkbox"]').prop("disabled","disabled"),bp.Access_Control_Admin.changeNotices()):n(s).siblings(".access-control-checkbox-list").html(""),n(s).removeClass("loading")},error:function(){n(s).removeClass("loading"),n(s).siblings(".loader-repair-tools").remove()}}))}},enableDisableOptions:function(e){var s=e.currentTarget,c=n(s).closest(".parent").next(".access-control-checkbox-list").find('input[type="checkbox"]');n(s).prop("checked")?c.removeProp("disabled"):(c.prop("disabled","disabled"),c.removeProp("checked"))},changeNotices:function(){var e,s,o;n(".access-control-checkbox-list .access-control-checkbox-list .description").length&&(e=n(".access-control-select-box").val(),o="",o="membership"===e?(s=n(".access-control-select-box option:selected").text(),n(".access-control-plugin-select-box option[value="+n(".access-control-plugin-select-box").val()+"]").text()+" "+s):"gamipress"===e?n(".access-control-gamipress-select-box option[value="+n(".access-control-gamipress-select-box").val()+"]").text():n(".access-control-select-box option[value="+n(".access-control-select-box").val()+"]").text(),n(".access-control-checkbox-list .access-control-checkbox-list .description").each(function(){var e=n(this).text(),s=bp.Access_Control_Admin.replaceAll(e,"{{select_value}}",o);n(this).text(s);var c=n(this).parent().prev(".parent").children("label").text(),t=n(this).text().replace("{{option_value}}","<strong>"+c+"</strong>");n(this).html(t)}))},replaceAll:function(e,s,c){var t=s.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");return e.replace(new RegExp(t,"g"),c)},group_creation_restrict:function(e){n(e.currentTarget).prop("checked")?(n("#group_access_control_block tr:first-child td .bp-messages-feedback").hide(),n("#group_access_control_block tr:first-child td select:disabled").prop("disabled",!1),n("#group_access_control_block tr:first-child td .access-control-checkbox-list input").prop("disabled",!1)):(n("#group_access_control_block tr:first-child td .bp-messages-feedback").show(),n("#group_access_control_block tr:first-child td select:visible").prop("disabled",!0),n("#group_access_control_block tr:first-child td .access-control-checkbox-list input").prop("disabled",!0))},upload_photo_restrict:function(){1<=n("input#bp_media_profile_media_support:checked, input#bp_media_messages_media_support:checked, input#bp_media_forums_media_support:checked").length?(n("#media_access_control_block tr:first-child td .bp-messages-feedback").hide(),n("#media_access_control_block tr:first-child td select:visible").prop("disabled",!1),n("#media_access_control_block tr:first-child td .access-control-checkbox-list input").prop("disabled",!1)):0===n("input#bp_media_profile_media_support:checked, input#bp_media_messages_media_support:checked, input#bp_media_forums_media_support:checked").length&&(n("#media_access_control_block tr:first-child td .bp-messages-feedback").show(),n("#media_access_control_block tr:first-child td select:visible").prop("disabled",!0),n("#media_access_control_block tr:first-child td .access-control-checkbox-list input").prop("disabled",!0))},upload_document_restrict:function(){1<=n("input#bp_media_profile_document_support:checked, input#bp_media_messages_document_support:checked, input#bp_media_forums_document_support:checked").length?(n("#media_access_control_block tr:nth-child(2) td .bp-messages-feedback").hide(),n("#media_access_control_block tr:nth-child(2) td select:visible").prop("disabled",!1),n("#media_access_control_block tr:nth-child(2) td .access-control-checkbox-list input").prop("disabled",!1)):0===n("input#bp_media_profile_document_support:checked, input#bp_media_messages_document_support:checked, input#bp_media_forums_document_support:checked").length&&(n("#media_access_control_block tr:nth-child(2) td .bp-messages-feedback").show(),n("#media_access_control_block tr:nth-child(2) td select:visible").prop("disabled",!0),n("#media_access_control_block tr:nth-child(2) td .access-control-checkbox-list input").prop("disabled",!0))},upload_video_restrict:function(){1<=n("input#bp_video_profile_video_support:checked, input#bp_video_messages_video_support:checked, input#bp_video_forums_video_support:checked").length?(n("#media_access_control_block tr:nth-child(3) td .bp-messages-feedback").hide(),n("#media_access_control_block tr:nth-child(3) td select:visible").prop("disabled",!1),n("#media_access_control_block tr:nth-child(3) td .access-control-checkbox-list input").prop("disabled",!1)):0===n("input#bp_video_profile_video_support:checked, input#bp_video_messages_video_support:checked, input#bp_video_forums_video_support:checked").length&&(n("#media_access_control_block tr:nth-child(3) td .bp-messages-feedback").show(),n("#media_access_control_block tr:nth-child(3) td select:visible").prop("disabled",!0),n("#media_access_control_block tr:nth-child(3) td .access-control-checkbox-list input").prop("disabled",!0))}},bp.Access_Control_Admin.start()}((bp,jQuery));